## 4.  Работа с Weather API
Задача заключается в добавлении UI для отображения текущей погоды в указанном городе по следующему шаблону:

![Screenshot 2022-09-18 115346](https://user-images.githubusercontent.com/70028254/190894005-0f121276-af50-4ea7-ad6f-9dd9b54ad7ce.png)

- `Minsk` -  input,  в который будет вводиться имя города. По дефолту должен быть город Минск. После ввода нового города, этот город сохранятеся в Local Storage  и после перезагрузки страницы город остается в input и погода начинает отображаться для него (берем из Local Storage).
- Ниже рассполагается иконка погоды. C данными API  будет приходить идентификатор иконки, с помощью которого мы будем вытягивать необходимую иконку в файлах проекта.
- ниже рассполагается две секции на одной строке: температура в градусах цельсия по умолчанию и описание текущей погоды(берется из ответа API).
- последующие две строки - влажность воздуха и скорость ветра. Все эти данные также будут доступны с отвтом от API сервера.

### Дополнительное задание:
Справа от иконки погоды необходимо добавить кнопку, которая позволяет изменять метрику температуры. Изначальное значение температуры в градусах Цельсия. На кнопке к этот момент отображается символ Цельсия. При нажатии на кнопку, теипература начинает отображаться в градусах по Фарангейту и на кнопке символ цельсия заменяется на символ Фаренгейта. При последующем нажатии на кнопку происходит переключение с Фаренгейта на Цельсий и т.д.

### Пример решения: 
#### 1) Регистрация в OpenWeatherMap API
Данные о погоде предоставляют API погоды. 

Регистрируемся в OpenWeatherMap API [https://home.openweathermap.org/users/sign_up](https://home.openweathermap.org/users/sign_up)

На указанную при регистрации почту приходит письмо с предложением подтвердить e-mail. Подтверждаем.

На странице [https://home.openweathermap.org/api_keys](https://home.openweathermap.org/api_keys) видим свой API key, который будем импользовать в запросах.

#### 2) Получение информации о погоде
Для получения информации о погоде создаём ссылку
`https://api.openweathermap.org/data/2.5/weather?q=Минск&lang=ru&appid=08f2a575dda978b9c539199e54df03b0&units=metric`

Здесь:
- `Минск` - название города, можно указывать на русском или на английском языке, в последующем будет изменяться.
- `08f2a575dda978b9c539199e54df03b0` - API key полученный при регистрации - неизменный.
- `lang=ru` - язык отображения описания погоды (можно указать `lang=en`).
- `units=metric` - температура в градусах Цельсия (можно указать `units=imperial` для отображения температуры в градусах Фаренгейта). Необходимо будет изменять для доп. задания.

Дальше используйте только ссылку со своим собственным API key. Если использовать ссылку, пример которой приводится в задании, очень быстро исчерпается лимит API, и она перестанет работать.

#### 3) Просмотр информации о погоде
Переходим по созданной ссылке со своим собственным API key. На странице отображается информация о погоде. Для удобного её отображения установите расширение [**JSONView**](https://chrome.google.com/webstore/detail/jsonview/chklaanhfefbnpoihckbnefhakgolnmc?hl=ru)
Пример ссылки в адрессной строке:
![Screenshot 2022-09-18 121246](https://user-images.githubusercontent.com/70028254/190894781-0c750b2f-2a77-433a-b395-0ac9e3eb92a9.png)
Подчеркнутая синим часть строки - твой личный API  ключ из [https://home.openweathermap.org/api_keys](https://home.openweathermap.org/api_keys)
Красным подчеркнут город. Можно вместо `Минск` ввести `Гродно` или `Солигорск` и получить данные по этим городам.
По ссылке отображается объект с погодой. 
![Screenshot 2022-09-18 121913](https://user-images.githubusercontent.com/70028254/190895080-8e4f6ac0-12fc-4c5c-8840-b4f3e0e0c3ea.png)

Некоторые свойства данного объекта, которые мы можем использовать:
- `.weather[0].id` - id иконки погоды
- `.weather[0].description` - описание погоды
- `.main.temp` - температура

#### 4) Вывод информации о погоде в консоль
Получим информацию о погоде. Пока выведем её в консоль.

Для этого создадим асинхронную функцию:
```js
async function getWeather() {  
  const url = `https://api.openweathermap.org/data/2.5/weather?q=Минск&lang=ru&appid=08f2a575dda978b9c539199e54df03b0&units=metric`;
  const res = await fetch(url);
  const data = await res.json(); 
  console.log(data.weather[0].id, data.weather[0].description, data.main.temp);
}
getWeather()
```
В функции `getWeather()` мы получили объект с погодой `data` и вывели в консоль интересующие нас свойства.

Ссылка в косых кавычках - шаблонная строка. Позже нам понадобится возможность добавить в шаблонную строку значение переменной - название указанного пользователем города.

Функция `getWeather()` не большая, не сложная. Единственное её неудобство - все полученные данные доступны исключительно внутри самой функции, получить их в основном коде невозможно. Асинхронные функции связаны с получением ответа от сервера и выполняются после того, как отработал весь код приложения. Это необходимо для того, чтобы весь код приложения не ждал пока асинхронная функция вернёт или не вернёт результат. 

#### 5) Вывод информации о погоде на страницу
Выведем полученные данные на страницу
В `index.html` создадим элементы для отображения иконки погоды, температуры и описания погоды:
```html
<i class="weather-icon owf"></i>
<div class="temperature"></div>
<div class="weather-description"></div>
```
В js-коде найдём эти элементы:
```js
const weatherIcon = document.querySelector('.weather-icon');
const temperature = document.querySelector('.temperature');
const weatherDescription = document.querySelector('.weather-description');
```
И внутри функции `getWeather()` укажем их содержание:
```js
async function getWeather() {
  const url = `https://api.openweathermap.org/data/2.5/weather?q=Минск&lang=ru&appid=08f2a575dda978b9c539199e54df03b0&units=metric`;
  const res = await fetch(url);
  const data = await res.json();
  weatherIcon.classList.add(`owf-${data.weather[0].id}`);
  temperature.textContent = `${data.main.temp}°C`;
  weatherDescription.textContent = data.weather[0].description;
}
```
Блокам с температурой и описанием погоды мы указали `textContent`, иконке погоды добавили класс.

#### 6) Отображение иконки погоды
Иконки погоды для Open Weather Map API находятся здесь https://websygen.github.io/owfont/
Скачиваем, распаковываем, папку `fonts` помещаем в папку с проектом, файл `owfont-regular.css` из скачанной папки `css` помещаем в папку `css` нашего проекта, подключаем в `index.html`  перед подключением `style.css`. 
```html
<link rel="stylesheet" href="css/owfont-regular.css">
```
Необходимо проверить правильность ссылки на css-файл c иконками!

### 7) Получаем погоду для определённого города
Заведем глобальную переменную `city`, которая будет обозначать текущий город. Эта переменная при загрузке скрипта в первую очередь должна получить из localStorage город(если был введен ранее). Если город не был сохранен, то мутод `localStorage.getItem('city')` вернет `null`, в таком случае мы должны присвоить переменной `city` дефолтное значение `Минск`:
```js
const currentCity = localStorage.getItem('currentCity') || "Минск";
```
Когда пользователь ввёл название города в предназначенный для этого `input` с классом `city` нам необходимо получить информацию о том, какой город он указал.
Для этого находим соответствующий элемент и назначаем ему слушатель события `change`, который сработает если пользователь нажмёт клавишу `Enter` или фокус уйдёт из поля `input`. Когда на `input` произойдёт событие `change`, вызываем функцию:
```js
city.addEventListener('change', (e) => {
  currentCity = e.target.value (введенное значение в инпут)
  getWeather()
  localStorage.setItem('currentCity', currentCity (или e.target.value))
}
```
Как видим, внутри этой функции присваивается введенный город глобальной переменной `currentCity` и вызывается функция `getWeather`. В `getWeather` ссылка должна приобрести вид:
```js
const url = `https://api.openweathermap.org/data/2.5/weather?q=${currentCity}&lang=ru&appid=08f2a575dda978b9c539199e54df03b0&units=metric`;
```
Теперь у нас отображается погода того города, который указан в блоке `city`.
Так же стоит в этой функции для события 'change' сохранить в localStorage введенный город, что после перезагрузки страницы он бы сохранен.

В функции `getWeather()` перед добавлением иконке погоды дополнительного класса укажем строку
```js
weatherIcon.className = 'weather-icon owf';
```
Этой строкой мы удаляем все лишние классы перед добавлением нового, чтобы иконка погоды обновлялась корректно.

[Код приложения](https://github.com/rolling-scopes-school/stage1-tasks/tree/gh-pages/weather)  
[Demo](https://rolling-scopes-school.github.io/stage1-tasks/weather/)

Доп. задание с изменением метрики температуры делается аналогично, только в ссылке изменяется `units` (в конце строки):
- `For temperature in Fahrenheit use units=imperial`
- `For temperature in Celsius use units=metric.`
